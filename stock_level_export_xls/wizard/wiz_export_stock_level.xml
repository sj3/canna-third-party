<odoo>

    <record id="wiz_export_stock_level_view_form" model="ir.ui.view">
        <field name="name">Generate stock level report</field>
        <field name="model">wiz.export.stock.level</field>
        <field name="arch" type="xml">
            <form string="Export File">
                <group name="date" col="4">
                    <separator
                        string="Enter the date for the Stock Level export:"
                        colspan="4" />
                    <field name="stock_level_date"
                        attrs="{'invisible': [('import_compatible', '=', True)]}" />
                    <field name="import_compatible" />
                </group>
                <group name="filters" col="4">
                    <separator string="Export Filters"
                        colspan="4" />
                    <field name="company_id" />
                    <field name="warehouse_id"
                        domain="[('company_id', '=', company_id)]"
                        attrs="{'invisible': [('import_compatible', '=', True)]}" />
                    <field name="location_id"
                        attrs="{'required': [('import_compatible', '=', True)]}" />
                    <field name="categ_id" />
                    <newline />
                    <field name="product_select"
                        invisible="not context.get('active_model') in ['product.product', 'product.template']" />
                </group>
                <footer>
                    <button icon="fa-cogs" name="xls_export"
                        string="Export" type="object" default_focus="1"
                        context="{'xls_export': 1}" />
                    or
                    <button string="Cancel" class="oe_link"
                        special="cancel" />
                </footer>
            </form>
        </field>
    </record>

    <act_window
        name="Stock Level Excel export"
        res_model="wiz.export.stock.level"
        binding_model="product.template"
        view_mode="form"
        target="new"
        view_id="wiz_export_stock_level_view_form"
        id="wiz_export_stock_level_action"/>

    <record id="action_xlsx_report" model="ir.actions.act_window">
        <field name="name">Excel</field>
        <field name="res_model">wiz.export.stock.level</field>
        <field name="type">ir.actions.act_window</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <menuitem id="excel_report" name="Excel Report"
        parent="stock.menu_warehouse_report" action="action_xlsx_report"/>

</odoo>